<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Yair Mau">
<meta name="dcterms.date" content="2026-01-31">
<meta name="description" content="not just algebraic manipulations, let’s see their geometric meaning">

<title>Legendre transformations – Yair Mau</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../archive/site_images/favicon.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-7b65e0acc1123cb31b45e68ef6c5ac2c.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-233e7f52a3823793d25c1ac516351062.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script type="module" src="../../site_libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="../../site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../archive/site_images/site-logo-light.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Yair Mau</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#motivation" id="toc-motivation" class="nav-link active" data-scroll-target="#motivation">motivation</a></li>
  <li><a href="#a-practical-example-that-doesnt-work" id="toc-a-practical-example-that-doesnt-work" class="nav-link" data-scroll-target="#a-practical-example-that-doesnt-work">a practical example that doesn’t work</a></li>
  <li><a href="#y-intercept-not-slope" id="toc-y-intercept-not-slope" class="nav-link" data-scroll-target="#y-intercept-not-slope">y-intercept, not slope</a></li>
  <li><a href="#derivation-according-to-v.i.-arnold" id="toc-derivation-according-to-v.i.-arnold" class="nav-link" data-scroll-target="#derivation-according-to-v.i.-arnold">derivation according to V.I. Arnold</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Legendre transformations</h1>
</div>

<div>
  <div class="description">
    not just algebraic manipulations, let’s see their geometric meaning
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Yair Mau </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 31, 2026</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>Inspired by Dan Kosakowski’s youtube video, <a href="https://youtu.be/P2HZelQm7Lw?si=vBaUeWywBtDsBIZq" target="_blank">A Simple yet Powerful Math Trick</a>.<br>
Folow his youtube channel, <a href="https://www.youtube.com/@AbideByReason" target="_blank">Abide by Reason</a>, it’s very good.</p>
<p>useful sources:</p>
<ul>
<li><a href="https://web.physics.wustl.edu/alford/physics/Legendre_introduction.pdf">Legendre transforms by Mark Alford</a>, read caption of figure 2</li>
<li><a href="https://www.aapt.org/docdirectory/meetingpresentations/sm14/mungan-poster.pdf">Legendre Transforms for Dummies, by Carl E. Mungan</a>. figure 1 is very good. The discussion in section “Inverse Legendre transform” is insightful, see especially Equation 14.</li>
<li><a href="https://math.arizona.edu/~glickenstein/tex/legendre.pdf">The Legendre Transform, by David Glickenstein</a> involution</li>
</ul>
<section id="motivation" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="motivation">motivation</h2>
<p>It is hard to give good motivations for the Legendre transform without goint into the physics of thermodynamics or classical mechanics. I’ll do that in another post. I’ll try to give here a mathematical motivation, which is to say, let’s clearly state what is the problem we would like to solve.</p>
<p>Suppose we have a function <span class="math inline">\(f(x)\)</span>. We can compute its derivative <span class="math inline">\(u = \frac{df}{dx}\)</span>. Can we express <strong>the same information</strong> contained in <span class="math inline">\(f(x)\)</span> through a new function <span class="math inline">\(g(u)\)</span>? What do I mean by “the same information”?</p>
<p><strong>Involution</strong><br>
Starting from <span class="math inline">\(f(x)\)</span>, we compute <span class="math inline">\(g(u)\)</span> with a given procedure (to be found below). Applying <strong>the same procedure</strong> to <span class="math inline">\(g(u)\)</span> gives us back <span class="math inline">\(f(x)\)</span>. <span class="math inline">\(f(x)\)</span> and <span class="math inline">\(g(u)\)</span> are but the sides of the same coin. By flipping the coin twice, we get back to where we started. This is what involution means.</p>
<p><strong>Conjugate variable swap</strong><br>
The independent variable of <span class="math inline">\(g\)</span> is <span class="math inline">\(u\)</span>, and it is defined as the derivative <span class="math inline">\(df/dx\)</span>. The independent variable of <span class="math inline">\(f\)</span> is <span class="math inline">\(x\)</span>, and it is defined as the derivative <span class="math inline">\(dg/du\)</span>. So the roles of dependent and independent variables are swapped, but in a very specific way.</p>
<div id="cell-fig-convex-concave" class="cell page-columns page-full" data-execution_count="114">

<div class="no-row-height column-margin column-container"><div class="cell-output cell-output-display">
<div id="fig-convex-concave" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-convex-concave-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-convex-concave-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-convex-concave-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Comparison of Convex and Concave functions.
</figcaption>
</figure>
</div>
</div></div></div>
<p><strong>Uniqueness</strong><br>
The original function <span class="math inline">\(f(x)\)</span> <strong>has to be convex</strong> (or concave) for the Legendre transform to be defined. Convexity (concavity) means that the second derivative is positive (negative). A geometric way to understand convexity is that if we draw a line between any two points of the graph of <span class="math inline">\(f(x)\)</span>, the line lies always above (or below) the graph. If this requirement is not satisfied, the mapping between <span class="math inline">\(x\)</span> and <span class="math inline">\(u\)</span> is no longer one-to-one, meaning we can no longer uniquely reconstruct the original function <span class="math inline">\(f(x)\)</span> from <span class="math inline">\(g(u)\)</span>.</p>
<p>The challenge, then, is to find a mathematical operation that satisfies all three criteria: it must be an involution, it must swap the variable with the derivative, and it must rely on the unique curvature of the function.</p>
</section>
<section id="a-practical-example-that-doesnt-work" class="level2">
<h2 class="anchored" data-anchor-id="a-practical-example-that-doesnt-work">a practical example that doesn’t work</h2>
<p>I’m following here Dan Kosakowski’s arguments, from his youtube video, <a href="https://youtu.be/P2HZelQm7Lw?si=vBaUeWywBtDsBIZq" target="_blank">A Simple yet Powerful Math Trick</a>.</p>
<p>We start with a function <span class="math inline">\(f(x)\)</span>. For this practical example we’ll choose a parabola. In panel <strong>a</strong> below, we plot the function</p>
<p><span class="math display">\[
f(x) = x^2.
\]</span></p>
<p>We then define the slope of the function as</p>
<p><span class="math display">\[
u = \frac{df}{dx}.
\]</span></p>
<p>Panel <strong>b</strong> shows that if we draw tangent lines to <span class="math inline">\(f(x)\)</span>, them make a nice envelope of the function itself, and that is a clue that maybe we can describe the function <span class="math inline">\(f\)</span> in terms of <span class="math inline">\(u\)</span> instead of <span class="math inline">\(x\)</span>.</p>
<div id="4c7d5af9" class="cell" data-execution_count="115">
<details class="code-fold">
<summary>import libraries</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="b95c1f49" class="cell" data-execution_count="132">
<details class="code-fold">
<summary>define useful functions</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(x):</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x<span class="op">**</span><span class="dv">2</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f_inverse(u):</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (u<span class="op">/</span><span class="dv">2</span>)<span class="op">**</span><span class="dv">2</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f2(x):</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (x <span class="op">-</span> <span class="dv">1</span>)<span class="op">**</span><span class="dv">2</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f_prime(x):</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">2</span> <span class="op">*</span> x</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f_prime2(x):</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">2</span> <span class="op">*</span> (x <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> tangent_line(x, x0):</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> f_prime(x0) <span class="op">*</span> (x <span class="op">-</span> x0) <span class="op">+</span> f(x0)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> tangent_line2(x, x0):</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> f_prime2(x0) <span class="op">*</span> (x <span class="op">-</span> x0) <span class="op">+</span> f2(x0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="86761029" class="cell" data-execution_count="133">
<details class="code-fold">
<summary>plot</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>fig, axx <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">8</span>,<span class="dv">8</span>))</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> axx.flatten()</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">100</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(x, f(x), label<span class="op">=</span><span class="st">'$f(x) = x^2$'</span>, color<span class="op">=</span><span class="st">'tab:blue'</span>, lw<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>x0_values <span class="op">=</span> np.arange(<span class="op">-</span><span class="fl">2.5</span>, <span class="fl">2.6</span>, <span class="fl">0.1</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x0 <span class="kw">in</span> x0_values:</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    ax[<span class="dv">1</span>].plot(x, tangent_line(x, x0), color<span class="op">=</span><span class="st">'gray'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>, lw<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(x, tangent_line(x, <span class="dv">1</span>), color<span class="op">=</span><span class="st">'black'</span>, lw<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>x1, x2 <span class="op">=</span> <span class="dv">1</span>, <span class="dv">2</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>y1, y2 <span class="op">=</span> tangent_line(x1, <span class="dv">1</span>), tangent_line(x2, <span class="dv">1</span>)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot([x1, x2], [y1, y1], color<span class="op">=</span><span class="st">'xkcd:bright pink'</span>)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot([x2, x2], [y1, y2], color<span class="op">=</span><span class="st">'xkcd:bright pink'</span>)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].text(x1<span class="op">+</span>(x2<span class="op">-</span>x1)<span class="op">/</span><span class="dv">2</span>, f(x1), <span class="st">'1'</span>, va<span class="op">=</span><span class="st">'bottom'</span>, ha<span class="op">=</span><span class="st">'center'</span>, color<span class="op">=</span><span class="st">'xkcd:bright pink'</span>)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].text(x2, y1 <span class="op">+</span> (y2<span class="op">-</span>y1)<span class="op">/</span><span class="dv">2</span>,</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>           <span class="vs">r'</span><span class="dv">$</span><span class="vs">u=</span><span class="dv">\d</span><span class="vs">frac{df}{dx}</span><span class="dv">$</span><span class="vs">'</span>, va<span class="op">=</span><span class="st">'center'</span>, ha<span class="op">=</span><span class="st">'left'</span>, color<span class="op">=</span><span class="st">'xkcd:bright pink'</span>)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> axis <span class="kw">in</span> ax[[<span class="dv">0</span>,<span class="dv">1</span>]]:</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    axis.spines[<span class="st">'left'</span>].set_position(<span class="st">'zero'</span>)</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    axis.spines[<span class="st">'bottom'</span>].set_position(<span class="st">'zero'</span>)</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    axis.spines[<span class="st">'right'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    axis.spines[<span class="st">'top'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>    axis.<span class="bu">set</span>(xlim<span class="op">=</span>(x[<span class="dv">0</span>], x[<span class="op">-</span><span class="dv">1</span>]),</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>             ylim<span class="op">=</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">5</span>),</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>             xticks<span class="op">=</span>np.arange(<span class="op">-</span><span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">1</span>),</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>             yticks<span class="op">=</span>np.arange(<span class="op">-</span><span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">1</span>)</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>    axis.set_xlabel(<span class="st">'$x$'</span>, loc<span class="op">=</span><span class="st">'right'</span>)</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_title(<span class="st">'Function $f(x)$'</span>)</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_xlabel(<span class="st">'$x$'</span>, loc<span class="op">=</span><span class="st">'right'</span>)</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_title(<span class="st">'Tangent lines to $f(x)$'</span>)</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a><span class="co"># ax[1].set_xlabel('$x$')</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].plot(x, f_prime(x), label<span class="op">=</span><span class="vs">r"</span><span class="dv">$</span><span class="vs">f'</span><span class="kw">(</span><span class="vs">x</span><span class="kw">)</span><span class="vs"> = 2x</span><span class="dv">$</span><span class="vs">"</span>, color<span class="op">=</span><span class="st">'black'</span>, lw<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].spines[<span class="st">'left'</span>].set_position(<span class="st">'zero'</span>)</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].spines[<span class="st">'bottom'</span>].set_position(<span class="st">'zero'</span>)</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].spines[<span class="st">'right'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].spines[<span class="st">'top'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].<span class="bu">set</span>(xlim<span class="op">=</span>(x[<span class="dv">0</span>], x[<span class="op">-</span><span class="dv">1</span>]),</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>            ylim<span class="op">=</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>),</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>            xticks<span class="op">=</span>np.arange(<span class="op">-</span><span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">1</span>),</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>            yticks<span class="op">=</span>np.arange(<span class="op">-</span><span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">5</span>),</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>            title<span class="op">=</span><span class="st">"Derivative $u=df/dx$"</span></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].set_xlabel(<span class="st">'$x$'</span>, loc<span class="op">=</span><span class="st">'right'</span>)</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>u <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">100</span>)</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">3</span>].plot(u, f_inverse(u), label<span class="op">=</span><span class="vs">r"</span><span class="dv">$</span><span class="vs">g</span><span class="kw">(</span><span class="vs">u</span><span class="kw">)</span><span class="vs"> = </span><span class="er">\</span><span class="vs">left</span><span class="kw">(</span><span class="ch">\f</span><span class="vs">rac{u}</span><span class="op">{2}</span><span class="ch">\r</span><span class="vs">ight</span><span class="kw">)</span><span class="dv">^</span><span class="vs">2</span><span class="dv">$</span><span class="vs">"</span>, color<span class="op">=</span><span class="st">'xkcd:bright pink'</span>, lw<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">3</span>].spines[<span class="st">'left'</span>].set_position(<span class="st">'zero'</span>)</span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">3</span>].spines[<span class="st">'bottom'</span>].set_position(<span class="st">'zero'</span>)</span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">3</span>].spines[<span class="st">'right'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">3</span>].spines[<span class="st">'top'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">3</span>].<span class="bu">set</span>(xlim<span class="op">=</span>(u[<span class="dv">0</span>], u[<span class="op">-</span><span class="dv">1</span>]),</span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>            ylim<span class="op">=</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">5</span>),</span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>            xticks<span class="op">=</span>np.arange(<span class="op">-</span><span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">1</span>),</span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>            yticks<span class="op">=</span>np.arange(<span class="op">-</span><span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">1</span>),</span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>            title<span class="op">=</span><span class="st">"function $g(u)$"</span>,</span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">3</span>].set_xlabel(<span class="st">'$u$'</span>, loc<span class="op">=</span><span class="st">'right'</span>)<span class="op">;</span></span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].text(<span class="fl">0.03</span>, <span class="fl">0.97</span>, <span class="vs">r"a"</span>, transform<span class="op">=</span>ax[<span class="dv">0</span>].transAxes,</span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>         horizontalalignment<span class="op">=</span><span class="st">'left'</span>, verticalalignment<span class="op">=</span><span class="st">'top'</span>,</span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>         fontweight<span class="op">=</span><span class="st">"bold"</span>)</span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].text(<span class="fl">0.03</span>, <span class="fl">0.97</span>, <span class="vs">r"b"</span>, transform<span class="op">=</span>ax[<span class="dv">1</span>].transAxes,</span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>         horizontalalignment<span class="op">=</span><span class="st">'left'</span>, verticalalignment<span class="op">=</span><span class="st">'top'</span>,</span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>         fontweight<span class="op">=</span><span class="st">"bold"</span>)</span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].text(<span class="fl">0.03</span>, <span class="fl">0.97</span>, <span class="vs">r"c"</span>, transform<span class="op">=</span>ax[<span class="dv">2</span>].transAxes,</span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>         horizontalalignment<span class="op">=</span><span class="st">'left'</span>, verticalalignment<span class="op">=</span><span class="st">'top'</span>,</span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>         fontweight<span class="op">=</span><span class="st">"bold"</span>)</span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">3</span>].text(<span class="fl">0.03</span>, <span class="fl">0.97</span>, <span class="vs">r"d"</span>, transform<span class="op">=</span>ax[<span class="dv">3</span>].transAxes, </span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>         horizontalalignment<span class="op">=</span><span class="st">'left'</span>, verticalalignment<span class="op">=</span><span class="st">'top'</span>,</span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>         fontweight<span class="op">=</span><span class="st">"bold"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-5-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Differentiating <span class="math inline">\(x^2\)</span> gives us a relation between <span class="math inline">\(u\)</span> and <span class="math inline">\(x\)</span>:</p>
<p><span class="math display">\[
u(x) = 2x,
\]</span></p>
<p>which can be seen in panel <strong>c</strong>.</p>
<p>Because this is a one-to-one relation, that is, for each <span class="math inline">\(x\)</span> there is a unique <span class="math inline">\(u\)</span> and vice versa, we can invert this relation to express <span class="math inline">\(x\)</span> in terms of <span class="math inline">\(u\)</span>:</p>
<p><span class="math display">\[
x(u) = \frac{u}{2}
\]</span></p>
<p>We need now a function <span class="math inline">\(g(u)\)</span>. A first guess of what <span class="math inline">\(g(u)\)</span> could be is:</p>
<p><span class="math display">\[
g(u) = f(x(u)) = \left(\frac{u}{2}\right)^2 = \frac{u^2}{4}.
\]</span></p>
<p>This last function is plotted in panel <strong>d</strong>.</p>
<p>Alas, our choice for the procedure <span class="math inline">\(g(u) = f(x(u))\)</span> is not a good one. To see why, we can try doing the procedure again, this time on a right-shifted version of <span class="math inline">\(f\)</span>:</p>
<p><span class="math display">\[
f_2(x) = (x - a)^2.
\]</span></p>
<p>The derivative of this new function defines <span class="math inline">\(u\)</span>:</p>
<p><span class="math display">\[\begin{align*}
u &amp;= \frac{df_2}{dx} \\
&amp; = \frac{d}{dx} (x - a)^2 \\
&amp; = 2(x-a).
\end{align*}\]</span></p>
<p>Expressing now <span class="math inline">\(x\)</span> in terms of <span class="math inline">\(u\)</span> gives</p>
<p><span class="math display">\[
x(u) = \frac{u}{2} + a.
\]</span></p>
<p>Finally, we substitute <span class="math inline">\(x(u)\)</span> back into <span class="math inline">\(f_2\)</span> to get</p>
<p><span class="math display">\[\begin{align*}
g_2(u) &amp;= f_2(x(u)) \\
&amp;= (x(u) - a)^2 \\
&amp;= \left(\frac{u}{2} + a - a\right)^2 \\
&amp;= \frac{u^2}{4}.
\end{align*}\]</span></p>
<p>This is exactly the same function we had before shifting the original function! We completely lost the information that the parabola was shifted. See panel <strong>d</strong> below, it is identical to panel <strong>d</strong> in the previous example.</p>
<div id="ac4ed309" class="cell" data-execution_count="135">
<details class="code-fold">
<summary>plot</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>fig, axx <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">8</span>,<span class="dv">8</span>))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> axx.flatten()</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">100</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(x, f2(x), label<span class="op">=</span><span class="st">'$f_2(x) = </span><span class="er">\</span><span class="st">cosh(x - 1)$'</span>, color<span class="op">=</span><span class="st">'tab:blue'</span>, lw<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>x0_values <span class="op">=</span> np.arange(x[<span class="dv">0</span>], x[<span class="op">-</span><span class="dv">1</span>]<span class="op">+</span><span class="fl">0.1</span>, <span class="fl">0.1</span>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x0 <span class="kw">in</span> x0_values:</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    ax[<span class="dv">1</span>].plot(x, tangent_line2(x, x0), color<span class="op">=</span><span class="st">'gray'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>, lw<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co"># ax[1].plot(x, tangent_line2(x, 1), color='black', lw=2)</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co"># x1, x2 = 1, 2</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co"># y1, y2 = tangent_line2(x1, 1), tangent_line2(x2, 1)</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co"># ax[1].plot([x1, x2], [y1, y1], color='xkcd:bright pink')</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="co"># ax[1].plot([x2, x2], [y1, y2], color='xkcd:bright pink')</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="co"># ax[1].text(x1+(x2-x1)/2, f2(x1), '1', va='bottom', ha='center', color='xkcd:bright pink')</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="co"># ax[1].text(x2, y1 + (y2-y1)/2,</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="co">#            r'$u=\dfrac{df}{dx}$', va='center', ha='left', color='xkcd:bright pink')</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> axis <span class="kw">in</span> ax[[<span class="dv">0</span>,<span class="dv">1</span>]]:</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>    axis.spines[<span class="st">'left'</span>].set_position(<span class="st">'zero'</span>)</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>    axis.spines[<span class="st">'bottom'</span>].set_position(<span class="st">'zero'</span>)</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>    axis.spines[<span class="st">'right'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>    axis.spines[<span class="st">'top'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>    axis.<span class="bu">set</span>(xlim<span class="op">=</span>(x[<span class="dv">0</span>], x[<span class="op">-</span><span class="dv">1</span>]),</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>             ylim<span class="op">=</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">5</span>),</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>             xticks<span class="op">=</span>np.arange(<span class="op">-</span><span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">1</span>),</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>             yticks<span class="op">=</span>np.arange(<span class="op">-</span><span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">1</span>)</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>    axis.set_xlabel(<span class="st">'$x$'</span>, loc<span class="op">=</span><span class="st">'right'</span>)</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_title(<span class="st">'Function $f(x)$'</span>)</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_xlabel(<span class="st">'$x$'</span>, loc<span class="op">=</span><span class="st">'right'</span>)</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_title(<span class="st">'Tangent lines to $f_2(x)$'</span>)</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a><span class="co"># ax[1].set_xlabel('$x$')</span></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].plot(x, f_prime2(x), label<span class="op">=</span><span class="vs">r"</span><span class="dv">$</span><span class="vs">f'</span><span class="kw">(</span><span class="vs">x</span><span class="kw">)</span><span class="vs"> = </span><span class="dv">\s</span><span class="vs">inh</span><span class="kw">(</span><span class="vs">x-1</span><span class="kw">)</span><span class="dv">$</span><span class="vs">"</span>, color<span class="op">=</span><span class="st">'black'</span>, lw<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].spines[<span class="st">'left'</span>].set_position(<span class="st">'zero'</span>)</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].spines[<span class="st">'bottom'</span>].set_position(<span class="st">'zero'</span>)</span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].spines[<span class="st">'right'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].spines[<span class="st">'top'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].<span class="bu">set</span>(xlim<span class="op">=</span>(x[<span class="dv">0</span>], x[<span class="op">-</span><span class="dv">1</span>]),</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>            ylim<span class="op">=</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>),</span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>            xticks<span class="op">=</span>np.arange(<span class="op">-</span><span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">1</span>),</span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>            yticks<span class="op">=</span>np.arange(<span class="op">-</span><span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">5</span>),</span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>            title<span class="op">=</span><span class="st">"Derivative $u_2=df_2/dx$"</span></span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].set_xlabel(<span class="st">'$x$'</span>, loc<span class="op">=</span><span class="st">'right'</span>)</span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>u <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">100</span>)</span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">3</span>].plot(u, f_inverse(u), label<span class="op">=</span><span class="vs">r"</span><span class="dv">$</span><span class="vs">f_2</span><span class="kw">(</span><span class="vs">x</span><span class="kw">(</span><span class="vs">u_2</span><span class="kw">))</span><span class="vs"> = </span><span class="er">\</span><span class="vs">cosh</span><span class="kw">(</span><span class="dv">\s</span><span class="vs">inh</span><span class="dv">^</span><span class="vs">{-1}</span><span class="kw">(</span><span class="vs">u_2</span><span class="kw">))</span><span class="dv">$</span><span class="vs">"</span>, color<span class="op">=</span><span class="st">'xkcd:bright pink'</span>, lw<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">3</span>].spines[<span class="st">'left'</span>].set_position(<span class="st">'zero'</span>)</span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">3</span>].spines[<span class="st">'bottom'</span>].set_position(<span class="st">'zero'</span>)</span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">3</span>].spines[<span class="st">'right'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">3</span>].spines[<span class="st">'top'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">3</span>].<span class="bu">set</span>(xlim<span class="op">=</span>(u[<span class="dv">0</span>], u[<span class="op">-</span><span class="dv">1</span>]),</span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>            ylim<span class="op">=</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">5</span>),</span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>            xticks<span class="op">=</span>np.arange(<span class="op">-</span><span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">1</span>),</span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>            yticks<span class="op">=</span>np.arange(<span class="op">-</span><span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">1</span>),</span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>            title<span class="op">=</span><span class="st">"function $f_2(u_2)$"</span>,</span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">3</span>].set_xlabel(<span class="st">'$u_2$'</span>, loc<span class="op">=</span><span class="st">'right'</span>)<span class="op">;</span></span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].text(<span class="fl">0.03</span>, <span class="fl">0.97</span>, <span class="vs">r"a"</span>, transform<span class="op">=</span>ax[<span class="dv">0</span>].transAxes,</span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a>         horizontalalignment<span class="op">=</span><span class="st">'left'</span>, verticalalignment<span class="op">=</span><span class="st">'top'</span>,</span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a>         fontweight<span class="op">=</span><span class="st">"bold"</span>)</span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].text(<span class="fl">0.03</span>, <span class="fl">0.97</span>, <span class="vs">r"b"</span>, transform<span class="op">=</span>ax[<span class="dv">1</span>].transAxes,</span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a>         horizontalalignment<span class="op">=</span><span class="st">'left'</span>, verticalalignment<span class="op">=</span><span class="st">'top'</span>,</span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a>         fontweight<span class="op">=</span><span class="st">"bold"</span>)</span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].text(<span class="fl">0.03</span>, <span class="fl">0.97</span>, <span class="vs">r"c"</span>, transform<span class="op">=</span>ax[<span class="dv">2</span>].transAxes,</span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a>         horizontalalignment<span class="op">=</span><span class="st">'left'</span>, verticalalignment<span class="op">=</span><span class="st">'top'</span>,</span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a>         fontweight<span class="op">=</span><span class="st">"bold"</span>)</span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">3</span>].text(<span class="fl">0.03</span>, <span class="fl">0.97</span>, <span class="vs">r"d"</span>, transform<span class="op">=</span>ax[<span class="dv">3</span>].transAxes, </span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true" tabindex="-1"></a>         horizontalalignment<span class="op">=</span><span class="st">'left'</span>, verticalalignment<span class="op">=</span><span class="st">'top'</span>,</span>
<span id="cb4-75"><a href="#cb4-75" aria-hidden="true" tabindex="-1"></a>         fontweight<span class="op">=</span><span class="st">"bold"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-6-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Just for completeness, let’s go back from <span class="math inline">\(g_2(u)\)</span> to <span class="math inline">\(f_2(x)\)</span>:</p>
<p><span class="math display">\[\begin{align*}
x &amp;= \frac{dg_2}{du} \\
&amp;= \frac{d}{du} \left(\frac{u}{2}\right)^2 \\
&amp;= \frac{u}{2},
\end{align*}\]</span></p>
<p>And now:</p>
<p><span class="math display">\[
f_2(x) = g_2(u(x)) = g_2(2x) = \left(\frac{2x}{2}\right)^2 = x^2,
\]</span></p>
<p>which is not the shifted parabola we started with.</p>
</section>
<section id="y-intercept-not-slope" class="level2">
<h2 class="anchored" data-anchor-id="y-intercept-not-slope">y-intercept, not slope</h2>
<p>We learned that using the slope <span class="math inline">\(u = df/dx\)</span> to define a new function <span class="math inline">\(g(u)=f(x(u))\)</span> does not work. Instead, let’s try using the y-intercept of the tangent line as our function <span class="math inline">\(-g(u)\)</span>. The negative sign here will be justified later. The general equation for the tangent line is</p>
<p><span class="math display">\[
y = mx - g.
\]</span></p>
<div id="c77e0a79" class="cell" data-execution_count="147">
<details class="code-fold">
<summary>plot</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">8</span>,<span class="dv">6</span>))</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">100</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>ax.plot(x, f(x), label<span class="op">=</span><span class="st">'$f(x) = </span><span class="er">\</span><span class="st">cosh(x)$'</span>, color<span class="op">=</span><span class="st">'tab:blue'</span>, lw<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>ax.plot(x, tangent_line(x, <span class="dv">1</span>), color<span class="op">=</span><span class="st">'black'</span>, lw<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>x1, x2 <span class="op">=</span> <span class="dv">1</span>, <span class="dv">2</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>y1, y2 <span class="op">=</span> tangent_line(x1, <span class="dv">1</span>), tangent_line(x2, <span class="dv">1</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>ax.plot([x1, x2], [y1, y1], color<span class="op">=</span><span class="st">'xkcd:bright pink'</span>)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>ax.plot([x2, x2], [y1, y2], color<span class="op">=</span><span class="st">'xkcd:bright pink'</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>ax.plot([<span class="dv">0</span>,], [<span class="op">-</span><span class="dv">1</span>], ls<span class="op">=</span><span class="st">'None'</span>, marker<span class="op">=</span><span class="st">'o'</span>,</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>        mec<span class="op">=</span><span class="st">'xkcd:bright pink'</span>, mfc<span class="op">=</span><span class="st">"None"</span>, markersize<span class="op">=</span><span class="dv">8</span>, markeredgewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>ax.text(<span class="fl">0.3</span>, <span class="op">-</span><span class="dv">1</span>, <span class="vs">r'</span><span class="dv">$</span><span class="vs">-g</span><span class="dv">$</span><span class="vs">'</span>, va<span class="op">=</span><span class="st">'top'</span>, ha<span class="op">=</span><span class="st">'right'</span>, color<span class="op">=</span><span class="st">'xkcd:bright pink'</span>)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>ax.text(x1<span class="op">+</span>(x2<span class="op">-</span>x1)<span class="op">/</span><span class="dv">2</span>, f(x1), <span class="st">'1'</span>, va<span class="op">=</span><span class="st">'bottom'</span>, ha<span class="op">=</span><span class="st">'center'</span>, color<span class="op">=</span><span class="st">'xkcd:bright pink'</span>)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>ax.text(x2, y1 <span class="op">+</span> (y2<span class="op">-</span>y1)<span class="op">/</span><span class="dv">2</span>,</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>        <span class="vs">r'</span><span class="dv">$</span><span class="vs">u=</span><span class="dv">\d</span><span class="vs">frac{df}{dx}</span><span class="dv">$</span><span class="vs">'</span>, va<span class="op">=</span><span class="st">'center'</span>, ha<span class="op">=</span><span class="st">'left'</span>, color<span class="op">=</span><span class="st">'xkcd:bright pink'</span>)</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>ax.spines[<span class="st">'left'</span>].set_position(<span class="st">'zero'</span>)</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>ax.spines[<span class="st">'bottom'</span>].set_position(<span class="st">'zero'</span>)</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>ax.spines[<span class="st">'right'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>ax.spines[<span class="st">'top'</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>ax.<span class="bu">set</span>(xlim<span class="op">=</span>(x[<span class="dv">0</span>], x[<span class="op">-</span><span class="dv">1</span>]),</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>            ylim<span class="op">=</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>            xticks<span class="op">=</span>np.arange(<span class="op">-</span><span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">1</span>),</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>            yticks<span class="op">=</span>np.arange(<span class="op">-</span><span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">1</span>),</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>            title<span class="op">=</span><span class="vs">r"</span><span class="dv">$</span><span class="vs">g</span><span class="kw">(</span><span class="vs">u</span><span class="kw">)</span><span class="dv">$</span><span class="vs"> as the negative y-intercept of the tangent line"</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'$x$'</span>, loc<span class="op">=</span><span class="st">'right'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-7-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The slope <span class="math inline">\(m\)</span> was already defined as <span class="math inline">\(u = f'(x)\)</span>, so we have</p>
<p><span class="math display">\[
y = ux - g.
\]</span></p>
<p>The tangent line evaluated at <span class="math inline">\(x_0\)</span> touches the function at <span class="math inline">\(f(x_0)\)</span>, so we can use that to find <span class="math inline">\(g\)</span>:</p>
<p><span class="math display">\[\begin{align*}
f(x_0) &amp;= ux_0 - g \\
g &amp;= ux_0 - f(x_0).
\end{align*}\]</span></p>
<p>For a tangent line at a generic point <span class="math inline">\(x\)</span>, we have that the intercept is</p>
<p><span class="math display">\[
g(u) = u\cdot x - f(x).
\]</span></p>
<p>Let’s use the formula above to compute <span class="math inline">\(g(u)\)</span> for our shifted parabola <span class="math inline">\(f(x) = (x-a)^2\)</span>.</p>
<p><span class="math display">\[\begin{align*}
u &amp;= \frac{df}{dx} \\
&amp;= \frac{d}{dx} (x-a)^2 \\
&amp;= 2(x-a),
\end{align*}\]</span></p>
<p>which we can invert to get <span class="math display">\[
x(u) = \frac{u}{2} + a.
\]</span></p>
<p>Substituting into the formula for <span class="math inline">\(g(u)\)</span> gives</p>
<p><span class="math display">\[\begin{align*}
g(u) &amp;= u \cdot x(u) - f(x(u)) \\
&amp;= u \cdot \left(\frac{u}{2} + a\right) - \left(\frac{u}{2} + a - a\right)^2 \\
&amp;= u \cdot \left(\frac{u}{2} + a\right) - \left(\frac{u}{2}\right)^2 \\
&amp;= \frac{u^2}{2} + ua - \frac{u^2}{4} \\
&amp;= \frac{u^2}{4} + ua.
\end{align*}\]</span></p>
<p>This function is different from the one we obtained before, and it contains the information about the shift <span class="math inline">\(a\)</span>. Now let’s try going back from <span class="math inline">\(g(u)\)</span> to <span class="math inline">\(f(x)\)</span>.</p>
<p><span class="math display">\[\begin{align*}
x &amp;= \frac{dg}{du} \\
&amp;= \frac{d}{du} \left(\frac{u^2}{4} + ua\right) \\
&amp;= \frac{u}{2} + a,
\end{align*}\]</span></p>
<p>Solving for <span class="math inline">\(u\)</span> gives <span class="math inline">\(u = 2(x - a)\)</span>.</p>
<p>And now: <span class="math display">\[\begin{align*}
f(x) &amp;= u\cdot x - g(u(x)) \\
&amp;= 2(x - a) \cdot x - \left(\frac{(2(x - a))^2}{4} + 2(x - a)a\right) \\
&amp;= 2(x - a) \cdot x - \left((x - a)^2 + 2a(x - a)\right) \\
&amp;= 2(x - a) \cdot x - (x - a)^2 - 2a(x - a) \\
&amp;= (x - a)^2.
\end{align*}\]</span></p>
<p>Success!</p>
</section>
<section id="derivation-according-to-v.i.-arnold" class="level2">
<h2 class="anchored" data-anchor-id="derivation-according-to-v.i.-arnold">derivation according to V.I. Arnold</h2>
<blockquote class="blockquote">
<p><strong>Legendre transformations</strong><br>
The Legendre transformation is a very useful mathematical tool: it transforms functions on a vector space to functions on the dual space. Legendre transformations are related to projective duality and tangential coordinates in algebraic geometry and the construction of dual Banach spaces in analysis. They are often encountered in physics (for example, in the definition of thermodynamic quantities).</p>
<p><strong>Definition</strong><br>
Let <span class="math inline">\(y=f(x)\)</span> be a convex function, <span class="math inline">\(f''(x)&gt;0\)</span>.<br>
The <em>Legendre transformation</em> of the function <span class="math inline">\(f\)</span> is a new function <span class="math inline">\(g\)</span> of a new variable <span class="math inline">\(p\)</span>, which is constructed in the following way (Figure 43). We draw the graph of <span class="math inline">\(f\)</span> in the <span class="math inline">\(x,y\)</span> plane. Let <span class="math inline">\(p\)</span> be a given number. Consider the straight line <span class="math inline">\(y=px\)</span>. We take the point <span class="math inline">\(x=x(p)\)</span> at which the curve is farthest from the straight line in the vertical direction: for each <span class="math inline">\(p\)</span> the function <span class="math inline">\(px-f(x)=F(p,x)\)</span> has a maximum with respect to <span class="math inline">\(x\)</span> at the point <span class="math inline">\(x(p)\)</span>. Now we define <span class="math inline">\(g(p)=F(p,x(p))\)</span>.</p>
<p>The point <span class="math inline">\(x(p)\)</span> is defined by the extremal condition <span class="math inline">\(\partial F/\partial x=0\)</span>, i.e., <span class="math inline">\(f'(x)=p\)</span>. Since <span class="math inline">\(f\)</span> is convex, the point <span class="math inline">\(x(p)\)</span> is unique.</p>
<p><strong>Involutivity</strong><br>
Let us consider a function <span class="math inline">\(f\)</span> which is differentiable as many times as necessary, with <span class="math inline">\(f''(x) &gt; 0\)</span>. It is easy to verify that a Legendre transformation takes convex functions to convex functions. Therefore, we can apply it twice.</p>
<p><strong>Theorem.</strong> The Legendre transformation is involutive, i.e., its square is the identity: if under the Legendre transformation <span class="math inline">\(f\)</span> is taken to <span class="math inline">\(g\)</span>, then the Legendre transform of <span class="math inline">\(g\)</span> will again be <span class="math inline">\(f\)</span>.</p>
<p><strong>Proof.</strong> In order to apply the Legendre transform to <span class="math inline">\(g\)</span>, with variable <span class="math inline">\(p\)</span>, we must by definition look at a new independent variable (which we will call <span class="math inline">\(x\)</span>), construct the function <span class="math display">\[
G(x, p) = xp - g(p),
\]</span> and find the point <span class="math inline">\(p(x)\)</span> at which <span class="math inline">\(G\)</span> attains its maximum: <span class="math inline">\(\partial G/\partial p = 0\)</span>, i.e., <span class="math inline">\(g'(p) = x\)</span>. Then the Legendre transform of <span class="math inline">\(g(p)\)</span> will be the function of <span class="math inline">\(x\)</span> equal to <span class="math inline">\(G(x, p(x))\)</span>.</p>
<p>We will show that <span class="math inline">\(G(x, p(x)) = f(x)\)</span>. To this end we notice that <span class="math inline">\(G(x, p) = xp - q(p)\)</span> has a simple geometric interpretation: it is the ordinate of the point with abscissa <span class="math inline">\(x\)</span> on the line tangent to the graph of <span class="math inline">\(f(x)\)</span> with slope <span class="math inline">\(p\)</span> (Figure 45). For fixed <span class="math inline">\(p\)</span>, the function <span class="math inline">\(G(x, p)\)</span> is a linear function of <span class="math inline">\(x\)</span>, with <span class="math inline">\(\partial G/\partial x = p\)</span>, and for <span class="math inline">\(x = x(p)\)</span> we have <span class="math inline">\(G(x, p) = xp - g(p) = f(x)\)</span> by the definition of <span class="math inline">\(g(p)\)</span>.</p>
<p>Let us now fix <span class="math inline">\(x = x_0\)</span> and vary <span class="math inline">\(p\)</span>. Then the values of <span class="math inline">\(G(x,p)\)</span> will be the ordinates of the points of intersection of the line <span class="math inline">\(x=x_0\)</span> with the line tangen to the graph of <span class="math inline">\(f(x)\)</span> with various slopes <span class="math inline">\(p\)</span>. By the convexity of the graph it follows that all these tangents lie below the curve, and therefore the maximum of <span class="math inline">\(G(x,p)\)</span> for a fixed <span class="math inline">\(x(p_0)\)</span> is equal to <span class="math inline">\(f(x)\)</span> (and is achieed for <span class="math inline">\(p=p(x_0)=f'(x_0)\)</span>).</p>
</blockquote>
<div id="interactive-container" style="display: flex; flex-direction: column; align-items: center;">
<div class="cell">
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden" id="cb6" data-startfrom="2" data-source-offset="-1"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1;"><span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>blue_color <span class="op">=</span> <span class="st">"#0343df"</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>red_color <span class="op">=</span> <span class="st">"#e50000"</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>light_blue_color <span class="op">=</span> <span class="st">"#95d0fc"</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">// 1. Define the slider without a label to keep it tight</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>viewof p <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">4</span>]<span class="op">,</span> {</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="dt">step</span><span class="op">:</span> <span class="fl">0.1</span><span class="op">,</span> </span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="dt">value</span><span class="op">:</span> <span class="fl">2.5</span><span class="op">,</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="dt">width</span><span class="op">:</span> <span class="dv">250</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co">// 2. Create a centered row using a template literal</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co">// This puts "Slope p" right next to the number box</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`&lt;div style="display: flex; align-items: center; gap: 10px; font-weight: bold; font-family: sans-serif; margin-bottom: 15px;"&gt;</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;span&gt;Slope p&lt;/span&gt; </span><span class="sc">${</span>viewof p<span class="sc">}</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/div&gt;`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-5" data-nodetype="expression">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden" id="cb7" data-startfrom="18" data-source-offset="-491"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 17;"><span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>xo <span class="op">=</span> p <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="co">// 3. Define the plot</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>  <span class="dt">grid</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marginLeft</span><span class="op">:</span> <span class="dv">60</span><span class="op">,</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marginBottom</span><span class="op">:</span> <span class="dv">60</span><span class="op">,</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>  <span class="dt">width</span><span class="op">:</span> <span class="dv">600</span><span class="op">,</span> </span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>  <span class="dt">style</span><span class="op">:</span> { <span class="dt">fontSize</span><span class="op">:</span> <span class="dv">14</span> }<span class="op">,</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>  <span class="dt">x</span><span class="op">:</span> { <span class="dt">domain</span><span class="op">:</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">3</span>]<span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"x →"</span><span class="op">,</span> <span class="dt">labelOffset</span><span class="op">:</span> <span class="dv">45</span> }<span class="op">,</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>  <span class="dt">y</span><span class="op">:</span> { <span class="dt">domain</span><span class="op">:</span> [<span class="op">-</span><span class="dv">4</span><span class="op">,</span> <span class="dv">8</span>]<span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"↑ y"</span><span class="op">,</span> <span class="dt">labelOffset</span><span class="op">:</span> <span class="dv">50</span> }<span class="op">,</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">axisX</span>({<span class="dt">fontSize</span><span class="op">:</span> <span class="dv">20</span><span class="op">,</span> <span class="dt">fontWeight</span><span class="op">:</span> <span class="st">"bold"</span>})<span class="op">,</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">axisY</span>({<span class="dt">fontSize</span><span class="op">:</span> <span class="dv">20</span><span class="op">,</span> <span class="dt">fontWeight</span><span class="op">:</span> <span class="st">"bold"</span>})<span class="op">,</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Parabola</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">line</span>(d3<span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span> <span class="fl">3.1</span><span class="op">,</span> <span class="fl">0.1</span>)<span class="op">,</span> {</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>      <span class="dt">x</span><span class="op">:</span> d <span class="kw">=&gt;</span> d<span class="op">,</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>      <span class="dt">y</span><span class="op">:</span> d <span class="kw">=&gt;</span> d <span class="op">**</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>      <span class="dt">stroke</span><span class="op">:</span> <span class="st">"black"</span><span class="op">,</span></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>      <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">4</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>    })<span class="op">,</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Blue line</span></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">line</span>(d3<span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span> <span class="fl">3.1</span><span class="op">,</span> <span class="fl">0.1</span>)<span class="op">,</span> {</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>      <span class="dt">x</span><span class="op">:</span> d <span class="kw">=&gt;</span> d<span class="op">,</span></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>      <span class="dt">y</span><span class="op">:</span> d <span class="kw">=&gt;</span> p <span class="op">*</span> d<span class="op">,</span></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>      <span class="dt">stroke</span><span class="op">:</span> blue_color<span class="op">,</span></span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>      <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">4</span></span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>    })<span class="op">,</span></span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>    <span class="co">// LIGHT Blue line</span></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">link</span>([<span class="kw">null</span>]<span class="op">,</span> {</span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>      <span class="dt">x1</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">y1</span><span class="op">:</span> <span class="op">-</span>p <span class="op">*</span> p <span class="op">/</span> <span class="dv">4</span><span class="op">,</span></span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>      <span class="dt">x2</span><span class="op">:</span> <span class="dv">3</span><span class="op">,</span> <span class="dt">y2</span><span class="op">:</span> p<span class="op">*</span><span class="dv">3</span> <span class="op">-</span>p <span class="op">*</span> p <span class="op">/</span> <span class="dv">4</span><span class="op">,</span></span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>      <span class="dt">stroke</span><span class="op">:</span> light_blue_color<span class="op">,</span> <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>    })<span class="op">,</span></span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Red vertical segment</span></span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">link</span>([<span class="kw">null</span>]<span class="op">,</span> {</span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>      <span class="dt">x1</span><span class="op">:</span> p <span class="op">/</span> <span class="dv">2</span><span class="op">,</span> <span class="dt">y1</span><span class="op">:</span> (p <span class="op">**</span> <span class="dv">2</span>) <span class="op">/</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a>      <span class="dt">x2</span><span class="op">:</span> p <span class="op">/</span> <span class="dv">2</span><span class="op">,</span> <span class="dt">y2</span><span class="op">:</span> (p <span class="op">**</span> <span class="dv">2</span>) <span class="op">/</span> <span class="dv">4</span><span class="op">,</span></span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a>      <span class="dt">stroke</span><span class="op">:</span> red_color<span class="op">,</span> <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">5</span></span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a>    })<span class="op">,</span></span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a>    <span class="co">// The gray thick straight line (Vertical segment)</span></span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">link</span>([<span class="kw">null</span>]<span class="op">,</span> {</span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a>      <span class="dt">x1</span><span class="op">:</span> p <span class="op">/</span> <span class="dv">2</span><span class="op">,</span> <span class="dt">y1</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a>      <span class="dt">x2</span><span class="op">:</span> p <span class="op">/</span> <span class="dv">2</span><span class="op">,</span> <span class="dt">y2</span><span class="op">:</span> (p <span class="op">**</span> <span class="dv">2</span>) <span class="op">/</span> <span class="dv">4</span><span class="op">,</span></span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a>      <span class="dt">stroke</span><span class="op">:</span> <span class="st">"gray"</span><span class="op">,</span> <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">5</span></span>
<span id="cb7-68"><a href="#cb7-68" aria-hidden="true" tabindex="-1"></a>    })<span class="op">,</span></span>
<span id="cb7-69"><a href="#cb7-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-70"><a href="#cb7-70" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">ruleY</span>([<span class="dv">0</span>]<span class="op">,</span> {</span>
<span id="cb7-71"><a href="#cb7-71" aria-hidden="true" tabindex="-1"></a>      <span class="dt">stroke</span><span class="op">:</span> <span class="st">"#aaa"</span><span class="op">,</span>    <span class="co">// A light gray color</span></span>
<span id="cb7-72"><a href="#cb7-72" aria-hidden="true" tabindex="-1"></a>      <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span>    <span class="co">// Makes it "thin"</span></span>
<span id="cb7-73"><a href="#cb7-73" aria-hidden="true" tabindex="-1"></a>      <span class="dt">strokeOpacity</span><span class="op">:</span> <span class="fl">0.5</span> <span class="co">// Makes it subtle</span></span>
<span id="cb7-74"><a href="#cb7-74" aria-hidden="true" tabindex="-1"></a>    })<span class="op">,</span></span>
<span id="cb7-75"><a href="#cb7-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-76"><a href="#cb7-76" aria-hidden="true" tabindex="-1"></a>    <span class="co">// TEXT LABELS</span></span>
<span id="cb7-77"><a href="#cb7-77" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">text</span>([<span class="kw">null</span>]<span class="op">,</span> {</span>
<span id="cb7-78"><a href="#cb7-78" aria-hidden="true" tabindex="-1"></a>      <span class="dt">x</span><span class="op">:</span> <span class="fl">2.7</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="dv">8</span><span class="op">,</span> </span>
<span id="cb7-79"><a href="#cb7-79" aria-hidden="true" tabindex="-1"></a>      <span class="dt">text</span><span class="op">:</span> [<span class="st">"f(x)"</span>]<span class="op">,</span> </span>
<span id="cb7-80"><a href="#cb7-80" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fontSize</span><span class="op">:</span> <span class="dv">20</span><span class="op">,</span> <span class="dt">fontWeight</span><span class="op">:</span> <span class="st">"bold"</span><span class="op">,</span> <span class="dt">dy</span><span class="op">:</span> <span class="op">-</span><span class="dv">10</span> </span>
<span id="cb7-81"><a href="#cb7-81" aria-hidden="true" tabindex="-1"></a>    })<span class="op">,</span></span>
<span id="cb7-82"><a href="#cb7-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-83"><a href="#cb7-83" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">text</span>([<span class="kw">null</span>]<span class="op">,</span> {</span>
<span id="cb7-84"><a href="#cb7-84" aria-hidden="true" tabindex="-1"></a>      <span class="dt">x</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="dv">2</span> <span class="op">*</span> p<span class="op">,</span> </span>
<span id="cb7-85"><a href="#cb7-85" aria-hidden="true" tabindex="-1"></a>      <span class="dt">text</span><span class="op">:</span> [<span class="st">"px"</span>]<span class="op">,</span> </span>
<span id="cb7-86"><a href="#cb7-86" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fontSize</span><span class="op">:</span> <span class="dv">20</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> blue_color<span class="op">,</span> <span class="dt">textAnchor</span><span class="op">:</span> <span class="st">"start"</span><span class="op">,</span> <span class="dt">dx</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">dy</span><span class="op">:</span> <span class="dv">10</span> </span>
<span id="cb7-87"><a href="#cb7-87" aria-hidden="true" tabindex="-1"></a>    })<span class="op">,</span></span>
<span id="cb7-88"><a href="#cb7-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-89"><a href="#cb7-89" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">text</span>([<span class="kw">null</span>]<span class="op">,</span> {</span>
<span id="cb7-90"><a href="#cb7-90" aria-hidden="true" tabindex="-1"></a>      <span class="dt">x</span><span class="op">:</span> p <span class="op">/</span> <span class="dv">2</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> (p <span class="op">**</span> <span class="dv">2</span>) <span class="op">*</span> <span class="dv">3</span> <span class="op">/</span> <span class="dv">8</span><span class="op">,</span> </span>
<span id="cb7-91"><a href="#cb7-91" aria-hidden="true" tabindex="-1"></a>      <span class="dt">text</span><span class="op">:</span> [<span class="st">"g(p)"</span>]<span class="op">,</span> </span>
<span id="cb7-92"><a href="#cb7-92" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fontSize</span><span class="op">:</span> <span class="dv">15</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> red_color<span class="op">,</span> <span class="dt">fontWeight</span><span class="op">:</span> <span class="st">"bold"</span><span class="op">,</span> <span class="dt">dy</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">dx</span><span class="op">:</span> <span class="dv">20</span> </span>
<span id="cb7-93"><a href="#cb7-93" aria-hidden="true" tabindex="-1"></a>    })<span class="op">,</span></span>
<span id="cb7-94"><a href="#cb7-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-95"><a href="#cb7-95" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">text</span>([<span class="kw">null</span>]<span class="op">,</span> {</span>
<span id="cb7-96"><a href="#cb7-96" aria-hidden="true" tabindex="-1"></a>      <span class="dt">x</span><span class="op">:</span> p <span class="op">/</span> <span class="dv">2</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> (p <span class="op">**</span> <span class="dv">2</span>) <span class="op">*</span> <span class="dv">1</span> <span class="op">/</span> <span class="dv">8</span><span class="op">,</span> </span>
<span id="cb7-97"><a href="#cb7-97" aria-hidden="true" tabindex="-1"></a>      <span class="dt">text</span><span class="op">:</span> [<span class="st">"f(x)"</span>]<span class="op">,</span> </span>
<span id="cb7-98"><a href="#cb7-98" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fontSize</span><span class="op">:</span> <span class="dv">15</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"black"</span><span class="op">,</span> <span class="dt">fontWeight</span><span class="op">:</span> <span class="st">"bold"</span><span class="op">,</span> <span class="dt">dy</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">dx</span><span class="op">:</span> <span class="dv">20</span> </span>
<span id="cb7-99"><a href="#cb7-99" aria-hidden="true" tabindex="-1"></a>    })<span class="op">,</span></span>
<span id="cb7-100"><a href="#cb7-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-101"><a href="#cb7-101" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">text</span>([<span class="kw">null</span>]<span class="op">,</span> {</span>
<span id="cb7-102"><a href="#cb7-102" aria-hidden="true" tabindex="-1"></a>      <span class="dt">x</span><span class="op">:</span> p <span class="op">/</span> <span class="dv">2</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> </span>
<span id="cb7-103"><a href="#cb7-103" aria-hidden="true" tabindex="-1"></a>      <span class="dt">text</span><span class="op">:</span> [<span class="st">"x(p)"</span>]<span class="op">,</span> </span>
<span id="cb7-104"><a href="#cb7-104" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fontSize</span><span class="op">:</span> <span class="dv">16</span><span class="op">,</span> <span class="dt">fontWeight</span><span class="op">:</span> <span class="st">"bold"</span><span class="op">,</span> <span class="dt">dx</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">dy</span><span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"black"</span><span class="op">,</span> </span>
<span id="cb7-105"><a href="#cb7-105" aria-hidden="true" tabindex="-1"></a>    })<span class="op">,</span></span>
<span id="cb7-106"><a href="#cb7-106" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb7-107"><a href="#cb7-107" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-7" data-nodetype="expression">

</div>
</div>
</div>
</div>
<div id="interactive-container" style="display: flex; flex-direction: column; align-items: center;">
<div class="cell">
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden" id="cb8" data-startfrom="3" data-source-offset="-58"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2;"><span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>viewof x0 <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">3</span>]<span class="op">,</span> {</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">step</span><span class="op">:</span> <span class="fl">0.1</span><span class="op">,</span> </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">value</span><span class="op">:</span> <span class="fl">2.5</span><span class="op">,</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">width</span><span class="op">:</span> <span class="dv">250</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co">// 2. Create a centered row using a template literal</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co">// This puts "Slope p" right next to the number box</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`&lt;div style="display: flex; align-items: center; gap: 10px; font-weight: bold; font-family: sans-serif; margin-bottom: 15px;"&gt;</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;span&gt;x₀&lt;/span&gt; </span><span class="sc">${</span>viewof x0<span class="sc">}</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/div&gt;`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-2" data-nodetype="expression">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden" id="cb9" data-startfrom="15" data-source-offset="-414"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 14;"><span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>u <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> x0</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> u <span class="op">*</span> x0 <span class="op">-</span> (x0 <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="co">// 3. Define the plot</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>  <span class="dt">grid</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marginLeft</span><span class="op">:</span> <span class="dv">60</span><span class="op">,</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marginBottom</span><span class="op">:</span> <span class="dv">60</span><span class="op">,</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>  <span class="dt">width</span><span class="op">:</span> <span class="dv">600</span><span class="op">,</span> </span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>  <span class="dt">style</span><span class="op">:</span> { <span class="dt">fontSize</span><span class="op">:</span> <span class="dv">14</span> }<span class="op">,</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>  <span class="dt">x</span><span class="op">:</span> { <span class="dt">domain</span><span class="op">:</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">3</span>]<span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"x →"</span><span class="op">,</span> <span class="dt">labelOffset</span><span class="op">:</span> <span class="dv">45</span> }<span class="op">,</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>  <span class="dt">y</span><span class="op">:</span> { <span class="dt">domain</span><span class="op">:</span> [<span class="op">-</span><span class="dv">8</span><span class="op">,</span> <span class="dv">8</span>]<span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"↑ y"</span><span class="op">,</span> <span class="dt">labelOffset</span><span class="op">:</span> <span class="dv">50</span> }<span class="op">,</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">axisX</span>({<span class="dt">fontSize</span><span class="op">:</span> <span class="dv">20</span><span class="op">,</span> <span class="dt">fontWeight</span><span class="op">:</span> <span class="st">"bold"</span>})<span class="op">,</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">axisY</span>({<span class="dt">fontSize</span><span class="op">:</span> <span class="dv">20</span><span class="op">,</span> <span class="dt">fontWeight</span><span class="op">:</span> <span class="st">"bold"</span>})<span class="op">,</span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Parabola</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">line</span>(d3<span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span> <span class="fl">3.1</span><span class="op">,</span> <span class="fl">0.1</span>)<span class="op">,</span> {</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>      <span class="dt">x</span><span class="op">:</span> d <span class="kw">=&gt;</span> d<span class="op">,</span></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>      <span class="dt">y</span><span class="op">:</span> d <span class="kw">=&gt;</span> d <span class="op">**</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>      <span class="dt">stroke</span><span class="op">:</span> <span class="st">"black"</span><span class="op">,</span></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>      <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">4</span></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>    })<span class="op">,</span></span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Blue line</span></span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">link</span>([<span class="kw">null</span>]<span class="op">,</span> {</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>      <span class="dt">x1</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">y1</span><span class="op">:</span> <span class="op">-</span>g<span class="op">,</span></span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>      <span class="dt">x2</span><span class="op">:</span> <span class="dv">3</span><span class="op">,</span> <span class="dt">y2</span><span class="op">:</span> <span class="dv">3</span><span class="op">*</span>u <span class="op">-</span> g<span class="op">,</span></span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>      <span class="dt">stroke</span><span class="op">:</span> blue_color<span class="op">,</span> <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">5</span></span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>    })<span class="op">,</span></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Red vertical segment</span></span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">link</span>([<span class="kw">null</span>]<span class="op">,</span> {</span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>      <span class="dt">x1</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">y1</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>      <span class="dt">x2</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">y2</span><span class="op">:</span> <span class="op">-</span>g<span class="op">,</span></span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>      <span class="dt">stroke</span><span class="op">:</span> red_color<span class="op">,</span> <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">5</span></span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>    })<span class="op">,</span></span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a>    <span class="co">// black dashed vertical segment</span></span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">link</span>([<span class="kw">null</span>]<span class="op">,</span> {</span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a>      <span class="dt">x1</span><span class="op">:</span> x0<span class="op">,</span> <span class="dt">y1</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a>      <span class="dt">x2</span><span class="op">:</span> x0<span class="op">,</span> <span class="dt">y2</span><span class="op">:</span> x0 <span class="op">**</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a>      <span class="dt">stroke</span><span class="op">:</span> <span class="st">"black"</span><span class="op">,</span> <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span> <span class="dt">strokeDasharray</span><span class="op">:</span> <span class="st">"4 4"</span></span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a>    })<span class="op">,</span></span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-60"><a href="#cb9-60" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">dot</span>([<span class="kw">null</span>]<span class="op">,</span> {</span>
<span id="cb9-61"><a href="#cb9-61" aria-hidden="true" tabindex="-1"></a>      <span class="dt">x</span><span class="op">:</span> x0<span class="op">,</span> </span>
<span id="cb9-62"><a href="#cb9-62" aria-hidden="true" tabindex="-1"></a>      <span class="dt">y</span><span class="op">:</span> x0 <span class="op">**</span> <span class="dv">2</span><span class="op">,</span> </span>
<span id="cb9-63"><a href="#cb9-63" aria-hidden="true" tabindex="-1"></a>      <span class="dt">r</span><span class="op">:</span> <span class="dv">8</span><span class="op">,</span>            <span class="co">// Radius of the dot</span></span>
<span id="cb9-64"><a href="#cb9-64" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fill</span><span class="op">:</span> red_color<span class="op">,</span>   <span class="co">// Color of the dot</span></span>
<span id="cb9-65"><a href="#cb9-65" aria-hidden="true" tabindex="-1"></a>      <span class="dt">stroke</span><span class="op">:</span> <span class="st">"white"</span><span class="op">,</span> <span class="co">// Optional: adds an outline to make it pop</span></span>
<span id="cb9-66"><a href="#cb9-66" aria-hidden="true" tabindex="-1"></a>      <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">2</span></span>
<span id="cb9-67"><a href="#cb9-67" aria-hidden="true" tabindex="-1"></a>    })<span class="op">,</span></span>
<span id="cb9-68"><a href="#cb9-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-69"><a href="#cb9-69" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">ruleY</span>([<span class="dv">0</span>]<span class="op">,</span> {</span>
<span id="cb9-70"><a href="#cb9-70" aria-hidden="true" tabindex="-1"></a>      <span class="dt">stroke</span><span class="op">:</span> <span class="st">"#aaa"</span><span class="op">,</span>    <span class="co">// A light gray color</span></span>
<span id="cb9-71"><a href="#cb9-71" aria-hidden="true" tabindex="-1"></a>      <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span>    <span class="co">// Makes it "thin"</span></span>
<span id="cb9-72"><a href="#cb9-72" aria-hidden="true" tabindex="-1"></a>      <span class="dt">strokeOpacity</span><span class="op">:</span> <span class="fl">0.5</span> <span class="co">// Makes it subtle</span></span>
<span id="cb9-73"><a href="#cb9-73" aria-hidden="true" tabindex="-1"></a>    })<span class="op">,</span></span>
<span id="cb9-74"><a href="#cb9-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-75"><a href="#cb9-75" aria-hidden="true" tabindex="-1"></a>    <span class="co">// TEXT LABELS</span></span>
<span id="cb9-76"><a href="#cb9-76" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">text</span>([<span class="kw">null</span>]<span class="op">,</span> {</span>
<span id="cb9-77"><a href="#cb9-77" aria-hidden="true" tabindex="-1"></a>      <span class="dt">x</span><span class="op">:</span> <span class="fl">2.7</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="dv">8</span><span class="op">,</span> </span>
<span id="cb9-78"><a href="#cb9-78" aria-hidden="true" tabindex="-1"></a>      <span class="dt">text</span><span class="op">:</span> [<span class="st">"f(x)"</span>]<span class="op">,</span> </span>
<span id="cb9-79"><a href="#cb9-79" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fontSize</span><span class="op">:</span> <span class="dv">20</span><span class="op">,</span> <span class="dt">fontWeight</span><span class="op">:</span> <span class="st">"bold"</span><span class="op">,</span> <span class="dt">dy</span><span class="op">:</span> <span class="op">-</span><span class="dv">10</span> </span>
<span id="cb9-80"><a href="#cb9-80" aria-hidden="true" tabindex="-1"></a>    })<span class="op">,</span></span>
<span id="cb9-81"><a href="#cb9-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-82"><a href="#cb9-82" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">text</span>([<span class="kw">null</span>]<span class="op">,</span> {</span>
<span id="cb9-83"><a href="#cb9-83" aria-hidden="true" tabindex="-1"></a>      <span class="dt">x</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="op">-</span>g<span class="op">/</span><span class="dv">2</span><span class="op">,</span> </span>
<span id="cb9-84"><a href="#cb9-84" aria-hidden="true" tabindex="-1"></a>      <span class="dt">text</span><span class="op">:</span> [<span class="st">"g(x₀)"</span>]<span class="op">,</span> </span>
<span id="cb9-85"><a href="#cb9-85" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fontSize</span><span class="op">:</span> <span class="dv">16</span><span class="op">,</span> <span class="dt">fontWeight</span><span class="op">:</span> <span class="st">"bold"</span><span class="op">,</span> <span class="dt">dx</span><span class="op">:</span> <span class="dv">30</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> red_color<span class="op">,</span> </span>
<span id="cb9-86"><a href="#cb9-86" aria-hidden="true" tabindex="-1"></a>    })<span class="op">,</span></span>
<span id="cb9-87"><a href="#cb9-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-88"><a href="#cb9-88" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">text</span>([<span class="kw">null</span>]<span class="op">,</span> {</span>
<span id="cb9-89"><a href="#cb9-89" aria-hidden="true" tabindex="-1"></a>      <span class="dt">x</span><span class="op">:</span> x0<span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> </span>
<span id="cb9-90"><a href="#cb9-90" aria-hidden="true" tabindex="-1"></a>      <span class="dt">text</span><span class="op">:</span> [<span class="st">"x₀"</span>]<span class="op">,</span> </span>
<span id="cb9-91"><a href="#cb9-91" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fontSize</span><span class="op">:</span> <span class="dv">16</span><span class="op">,</span> <span class="dt">fontWeight</span><span class="op">:</span> <span class="st">"bold"</span><span class="op">,</span> <span class="dt">dx</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">dy</span><span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"black"</span><span class="op">,</span> </span>
<span id="cb9-92"><a href="#cb9-92" aria-hidden="true" tabindex="-1"></a>    })<span class="op">,</span></span>
<span id="cb9-93"><a href="#cb9-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-94"><a href="#cb9-94" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb9-95"><a href="#cb9-95" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-5" data-nodetype="expression">

</div>
</div>
</div>
</div>


</div>
</div>
</section>

</main> <!-- /main -->
<script type="ojs-module-contents">
eyJjb250ZW50cyI6W3sibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IlxuYmx1ZV9jb2xvciA9IFwiIzAzNDNkZlwiXG5yZWRfY29sb3IgPSBcIiNlNTAwMDBcIlxubGlnaHRfYmx1ZV9jb2xvciA9IFwiIzk1ZDBmY1wiXG4vLyAxLiBEZWZpbmUgdGhlIHNsaWRlciB3aXRob3V0IGEgbGFiZWwgdG8ga2VlcCBpdCB0aWdodFxudmlld29mIHAgPSBJbnB1dHMucmFuZ2UoWzAsIDRdLCB7XG4gIHN0ZXA6IDAuMSwgXG4gIHZhbHVlOiAyLjUsXG4gIHdpZHRoOiAyNTBcbn0pXG5cbi8vIDIuIENyZWF0ZSBhIGNlbnRlcmVkIHJvdyB1c2luZyBhIHRlbXBsYXRlIGxpdGVyYWxcbi8vIFRoaXMgcHV0cyBcIlNsb3BlIHBcIiByaWdodCBuZXh0IHRvIHRoZSBudW1iZXIgYm94XG5odG1sYDxkaXYgc3R5bGU9XCJkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogY2VudGVyOyBnYXA6IDEwcHg7IGZvbnQtd2VpZ2h0OiBib2xkOyBmb250LWZhbWlseTogc2Fucy1zZXJpZjsgbWFyZ2luLWJvdHRvbTogMTVweDtcIj5cbiAgPHNwYW4+U2xvcGUgcDwvc3Bhbj4gJHt2aWV3b2YgcH1cbjwvZGl2PmBcblxueG8gPSBwIC8gMlxuXG4vLyAzLiBEZWZpbmUgdGhlIHBsb3RcblBsb3QucGxvdCh7XG4gIGdyaWQ6IHRydWUsXG4gIG1hcmdpbkxlZnQ6IDYwLFxuICBtYXJnaW5Cb3R0b206IDYwLFxuICB3aWR0aDogNjAwLCBcbiAgc3R5bGU6IHsgZm9udFNpemU6IDE0IH0sXG4gIHg6IHsgZG9tYWluOiBbMCwgM10sIGxhYmVsOiBcIngg4oaSXCIsIGxhYmVsT2Zmc2V0OiA0NSB9LFxuICB5OiB7IGRvbWFpbjogWy00LCA4XSwgbGFiZWw6IFwi4oaRIHlcIiwgbGFiZWxPZmZzZXQ6IDUwIH0sXG4gIG1hcmtzOiBbXG4gICAgUGxvdC5heGlzWCh7Zm9udFNpemU6IDIwLCBmb250V2VpZ2h0OiBcImJvbGRcIn0pLFxuICAgIFBsb3QuYXhpc1koe2ZvbnRTaXplOiAyMCwgZm9udFdlaWdodDogXCJib2xkXCJ9KSxcblxuICAgIC8vIFBhcmFib2xhXG4gICAgUGxvdC5saW5lKGQzLnJhbmdlKDAsIDMuMSwgMC4xKSwge1xuICAgICAgeDogZCA9PiBkLFxuICAgICAgeTogZCA9PiBkICoqIDIsXG4gICAgICBzdHJva2U6IFwiYmxhY2tcIixcbiAgICAgIHN0cm9rZVdpZHRoOiA0XG4gICAgfSksXG4gICAgXG4gICAgLy8gQmx1ZSBsaW5lXG4gICAgUGxvdC5saW5lKGQzLnJhbmdlKDAsIDMuMSwgMC4xKSwge1xuICAgICAgeDogZCA9PiBkLFxuICAgICAgeTogZCA9PiBwICogZCxcbiAgICAgIHN0cm9rZTogYmx1ZV9jb2xvcixcbiAgICAgIHN0cm9rZVdpZHRoOiA0XG4gICAgfSksXG5cbiAgICAvLyBMSUdIVCBCbHVlIGxpbmVcbiAgICBQbG90LmxpbmsoW251bGxdLCB7XG4gICAgICB4MTogMCwgeTE6IC1wICogcCAvIDQsXG4gICAgICB4MjogMywgeTI6IHAqMyAtcCAqIHAgLyA0LFxuICAgICAgc3Ryb2tlOiBsaWdodF9ibHVlX2NvbG9yLCBzdHJva2VXaWR0aDogMixcbiAgICB9KSxcblxuICAgIC8vIFJlZCB2ZXJ0aWNhbCBzZWdtZW50XG4gICAgUGxvdC5saW5rKFtudWxsXSwge1xuICAgICAgeDE6IHAgLyAyLCB5MTogKHAgKiogMikgLyAyLFxuICAgICAgeDI6IHAgLyAyLCB5MjogKHAgKiogMikgLyA0LFxuICAgICAgc3Ryb2tlOiByZWRfY29sb3IsIHN0cm9rZVdpZHRoOiA1XG4gICAgfSksXG5cbiAgICAvLyBUaGUgZ3JheSB0aGljayBzdHJhaWdodCBsaW5lIChWZXJ0aWNhbCBzZWdtZW50KVxuICAgIFBsb3QubGluayhbbnVsbF0sIHtcbiAgICAgIHgxOiBwIC8gMiwgeTE6IDAsXG4gICAgICB4MjogcCAvIDIsIHkyOiAocCAqKiAyKSAvIDQsXG4gICAgICBzdHJva2U6IFwiZ3JheVwiLCBzdHJva2VXaWR0aDogNVxuICAgIH0pLFxuXG4gICAgUGxvdC5ydWxlWShbMF0sIHtcbiAgICAgIHN0cm9rZTogXCIjYWFhXCIsICAgIC8vIEEgbGlnaHQgZ3JheSBjb2xvclxuICAgICAgc3Ryb2tlV2lkdGg6IDIsICAgIC8vIE1ha2VzIGl0IFwidGhpblwiXG4gICAgICBzdHJva2VPcGFjaXR5OiAwLjUgLy8gTWFrZXMgaXQgc3VidGxlXG4gICAgfSksXG5cbiAgICAvLyBURVhUIExBQkVMU1xuICAgIFBsb3QudGV4dChbbnVsbF0sIHtcbiAgICAgIHg6IDIuNywgeTogOCwgXG4gICAgICB0ZXh0OiBbXCJmKHgpXCJdLCBcbiAgICAgIGZvbnRTaXplOiAyMCwgZm9udFdlaWdodDogXCJib2xkXCIsIGR5OiAtMTAgXG4gICAgfSksXG5cbiAgICBQbG90LnRleHQoW251bGxdLCB7XG4gICAgICB4OiAyLCB5OiAyICogcCwgXG4gICAgICB0ZXh0OiBbXCJweFwiXSwgXG4gICAgICBmb250U2l6ZTogMjAsIGZpbGw6IGJsdWVfY29sb3IsIHRleHRBbmNob3I6IFwic3RhcnRcIiwgZHg6IDAsIGR5OiAxMCBcbiAgICB9KSxcblxuICAgIFBsb3QudGV4dChbbnVsbF0sIHtcbiAgICAgIHg6IHAgLyAyLCB5OiAocCAqKiAyKSAqIDMgLyA4LCBcbiAgICAgIHRleHQ6IFtcImcocClcIl0sIFxuICAgICAgZm9udFNpemU6IDE1LCBmaWxsOiByZWRfY29sb3IsIGZvbnRXZWlnaHQ6IFwiYm9sZFwiLCBkeTogMCwgZHg6IDIwIFxuICAgIH0pLFxuXG4gICAgUGxvdC50ZXh0KFtudWxsXSwge1xuICAgICAgeDogcCAvIDIsIHk6IChwICoqIDIpICogMSAvIDgsIFxuICAgICAgdGV4dDogW1wiZih4KVwiXSwgXG4gICAgICBmb250U2l6ZTogMTUsIGZpbGw6IFwiYmxhY2tcIiwgZm9udFdlaWdodDogXCJib2xkXCIsIGR5OiAwLCBkeDogMjAgXG4gICAgfSksXG5cbiAgICBQbG90LnRleHQoW251bGxdLCB7XG4gICAgICB4OiBwIC8gMiwgeTogMCwgXG4gICAgICB0ZXh0OiBbXCJ4KHApXCJdLCBcbiAgICAgIGZvbnRTaXplOiAxNiwgZm9udFdlaWdodDogXCJib2xkXCIsIGR4OiAwLCBkeTogMTAsIGZpbGw6IFwiYmxhY2tcIiwgXG4gICAgfSksXG4gIF1cbn0pXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTIiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJcbi8vIDEuIERlZmluZSB0aGUgc2xpZGVyIHdpdGhvdXQgYSBsYWJlbCB0byBrZWVwIGl0IHRpZ2h0XG52aWV3b2YgeDAgPSBJbnB1dHMucmFuZ2UoWzAsIDNdLCB7XG4gIHN0ZXA6IDAuMSwgXG4gIHZhbHVlOiAyLjUsXG4gIHdpZHRoOiAyNTBcbn0pXG5cbi8vIDIuIENyZWF0ZSBhIGNlbnRlcmVkIHJvdyB1c2luZyBhIHRlbXBsYXRlIGxpdGVyYWxcbi8vIFRoaXMgcHV0cyBcIlNsb3BlIHBcIiByaWdodCBuZXh0IHRvIHRoZSBudW1iZXIgYm94XG5odG1sYDxkaXYgc3R5bGU9XCJkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogY2VudGVyOyBnYXA6IDEwcHg7IGZvbnQtd2VpZ2h0OiBib2xkOyBmb250LWZhbWlseTogc2Fucy1zZXJpZjsgbWFyZ2luLWJvdHRvbTogMTVweDtcIj5cbiAgPHNwYW4+eOKCgDwvc3Bhbj4gJHt2aWV3b2YgeDB9XG48L2Rpdj5gXG5cbnUgPSAyICogeDBcbmcgPSB1ICogeDAgLSAoeDAgKiogMilcblxuLy8gMy4gRGVmaW5lIHRoZSBwbG90XG5QbG90LnBsb3Qoe1xuICBncmlkOiB0cnVlLFxuICBtYXJnaW5MZWZ0OiA2MCxcbiAgbWFyZ2luQm90dG9tOiA2MCxcbiAgd2lkdGg6IDYwMCwgXG4gIHN0eWxlOiB7IGZvbnRTaXplOiAxNCB9LFxuICB4OiB7IGRvbWFpbjogWzAsIDNdLCBsYWJlbDogXCJ4IOKGklwiLCBsYWJlbE9mZnNldDogNDUgfSxcbiAgeTogeyBkb21haW46IFstOCwgOF0sIGxhYmVsOiBcIuKGkSB5XCIsIGxhYmVsT2Zmc2V0OiA1MCB9LFxuICBtYXJrczogW1xuICAgIFBsb3QuYXhpc1goe2ZvbnRTaXplOiAyMCwgZm9udFdlaWdodDogXCJib2xkXCJ9KSxcbiAgICBQbG90LmF4aXNZKHtmb250U2l6ZTogMjAsIGZvbnRXZWlnaHQ6IFwiYm9sZFwifSksXG5cbiAgICAvLyBQYXJhYm9sYVxuICAgIFBsb3QubGluZShkMy5yYW5nZSgwLCAzLjEsIDAuMSksIHtcbiAgICAgIHg6IGQgPT4gZCxcbiAgICAgIHk6IGQgPT4gZCAqKiAyLFxuICAgICAgc3Ryb2tlOiBcImJsYWNrXCIsXG4gICAgICBzdHJva2VXaWR0aDogNFxuICAgIH0pLFxuICAgIFxuICAgIC8vIEJsdWUgbGluZVxuICAgIFBsb3QubGluayhbbnVsbF0sIHtcbiAgICAgIHgxOiAwLCB5MTogLWcsXG4gICAgICB4MjogMywgeTI6IDMqdSAtIGcsXG4gICAgICBzdHJva2U6IGJsdWVfY29sb3IsIHN0cm9rZVdpZHRoOiA1XG4gICAgfSksXG5cbiAgICAvLyBSZWQgdmVydGljYWwgc2VnbWVudFxuICAgIFBsb3QubGluayhbbnVsbF0sIHtcbiAgICAgIHgxOiAwLCB5MTogMCxcbiAgICAgIHgyOiAwLCB5MjogLWcsXG4gICAgICBzdHJva2U6IHJlZF9jb2xvciwgc3Ryb2tlV2lkdGg6IDVcbiAgICB9KSxcblxuICAgIC8vIGJsYWNrIGRhc2hlZCB2ZXJ0aWNhbCBzZWdtZW50XG4gICAgUGxvdC5saW5rKFtudWxsXSwge1xuICAgICAgeDE6IHgwLCB5MTogMCxcbiAgICAgIHgyOiB4MCwgeTI6IHgwICoqIDIsXG4gICAgICBzdHJva2U6IFwiYmxhY2tcIiwgc3Ryb2tlV2lkdGg6IDIsIHN0cm9rZURhc2hhcnJheTogXCI0IDRcIlxuICAgIH0pLFxuXG4gICAgUGxvdC5kb3QoW251bGxdLCB7XG4gICAgICB4OiB4MCwgXG4gICAgICB5OiB4MCAqKiAyLCBcbiAgICAgIHI6IDgsICAgICAgICAgICAgLy8gUmFkaXVzIG9mIHRoZSBkb3RcbiAgICAgIGZpbGw6IHJlZF9jb2xvciwgICAvLyBDb2xvciBvZiB0aGUgZG90XG4gICAgICBzdHJva2U6IFwid2hpdGVcIiwgLy8gT3B0aW9uYWw6IGFkZHMgYW4gb3V0bGluZSB0byBtYWtlIGl0IHBvcFxuICAgICAgc3Ryb2tlV2lkdGg6IDJcbiAgICB9KSxcblxuICAgIFBsb3QucnVsZVkoWzBdLCB7XG4gICAgICBzdHJva2U6IFwiI2FhYVwiLCAgICAvLyBBIGxpZ2h0IGdyYXkgY29sb3JcbiAgICAgIHN0cm9rZVdpZHRoOiAyLCAgICAvLyBNYWtlcyBpdCBcInRoaW5cIlxuICAgICAgc3Ryb2tlT3BhY2l0eTogMC41IC8vIE1ha2VzIGl0IHN1YnRsZVxuICAgIH0pLFxuXG4gICAgLy8gVEVYVCBMQUJFTFNcbiAgICBQbG90LnRleHQoW251bGxdLCB7XG4gICAgICB4OiAyLjcsIHk6IDgsIFxuICAgICAgdGV4dDogW1wiZih4KVwiXSwgXG4gICAgICBmb250U2l6ZTogMjAsIGZvbnRXZWlnaHQ6IFwiYm9sZFwiLCBkeTogLTEwIFxuICAgIH0pLFxuXG4gICAgUGxvdC50ZXh0KFtudWxsXSwge1xuICAgICAgeDogMCwgeTogLWcvMiwgXG4gICAgICB0ZXh0OiBbXCJnKHjigoApXCJdLCBcbiAgICAgIGZvbnRTaXplOiAxNiwgZm9udFdlaWdodDogXCJib2xkXCIsIGR4OiAzMCwgZmlsbDogcmVkX2NvbG9yLCBcbiAgICB9KSxcblxuICAgIFBsb3QudGV4dChbbnVsbF0sIHtcbiAgICAgIHg6IHgwLCB5OiAwLCBcbiAgICAgIHRleHQ6IFtcInjigoBcIl0sIFxuICAgICAgZm9udFNpemU6IDE2LCBmb250V2VpZ2h0OiBcImJvbGRcIiwgZHg6IDAsIGR5OiAxMCwgZmlsbDogXCJibGFja1wiLCBcbiAgICB9KSxcblxuICBdXG59KVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdwJykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ3gwJykifV19
</script>
<script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../../posts/2025-01-31-legendre-transformations";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "../..";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>